<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>Expense Tracker</h1>

<form action="/add" method="post">
    <input type="text" name="name" placeholder="Expense Name" required>
    <input type="number" name="amount" placeholder="Amount" required>

    <!-- Category Select (Better UX) -->
    <select name="item_type" required>
        <option value="" disabled selected>Select Category</option>
        <option value="Food">Food</option>
        <option value="Transport">Transport</option>
        <option value="Shopping">Shopping</option>
        <option value="Bills">Bills</option>
        <option value="Entertainment">Entertainment</option>
        <option value="Other">Other</option>
    </select>

    <!-- Payment Type -->
    <select name="payment_type" required>
        <option value="" disabled selected>Payment Type</option>
        <option value="Cash">Cash</option>
        <option value="Card">Card</option>
        <option value="Online">Online</option>
        <option value="UPI">UPI</option>
    </select>

    <button type="submit">Add Expense</button>
</form>

<br>

<!-- ✅ Export CSV Button -->
<a href="/export">
    <button type="button">Export to CSV</button>
</a>

<hr>

<h2>Expenses</h2>
<table border="1" cellpadding="5">
    <thead>
        <tr>
            <th>S.N</th>
            <th>Name</th>
            <th>Amount</th>
            <th>Category</th>
            <th>Payment Type</th>
            <th>Date</th>
        </tr>
    </thead>
    <tbody>
        {% for expense in expenses %}
        <tr>
            <td>{{ expense.sn }}</td>
            <td>{{ expense.name }}</td>
            <td>{{ expense.amount }}</td>
            <td>{{ expense.item_type }}</td>
            <td>{{ expense.payment_type }}</td>
            <td>{{ expense.date }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<!-- ✅ Pie Chart -->
<h2>Expenses by Category</h2>
<canvas id="expenseChart" width="350" height="350"></canvas>

<script>
    const labels = {{ labels | tojson }};
    const data = {{ data | tojson }};

    if (labels.length > 0) {
        const ctx = document.getElementById('expenseChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: data
                }]
            }
        });
    } else {
        document.write("<p>No data to display chart yet.</p>");
    }
</script>

</body>
</html>


